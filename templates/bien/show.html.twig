{% extends 'base.html.twig' %}

{% block title %}Detalle de la Propiedad{% endblock %}

{% block body %}
<div>
    <header>
        {# Aqu√≠ va  nav  #}
    </header>
    <main>
        <img src="{{ asset(bien.foto) }}" alt="Imagen de {{ bien.typeDeBien }}" class="card-img-top" style="width:100%;height:200px;object-fit:cover;">


        <h2>
            {{ bien.typeDeBien|capitalize }} √† vendre
            {# Bot√≥n de favoritos solo para clientes autenticados #}
            {% if app.user and 'ROLE_CLIENT' in app.user.roles %}
                <button
                    class="btn-favorito"
                    data-id="{{ bien.id }}"
                    onclick="toggleFavorito({{ bien.id }})"
                >
                    <span id="icon-{{ bien.id }}">{{ esFavorito ? '‚ù§Ô∏è' : 'Agregar a Favorito ü§ç' }}</span>
                </button>
            {% endif %}
        </h2>

        <ul>
            <li><strong>Tipo:</strong> {{ bien.typeDeBien }}</li>
            <li><strong>Direcci√≥n:</strong> {{ bien.adresse }}</li>
            <li><strong>Precio:</strong> {{ bien.prix|number_format(0, ',', ' ') }} ‚Ç¨</li>
            <li><strong>Superficie:</strong> {{ bien.surfaceM2 }} m¬≤</li>
            <li><strong>Estado:</strong> {{ bien.etatDuBien }}</li>
        </ul>
        <div>
            <a href="{{ path('home') }}">‚Üê Volver al listado</a>
            <button type="button" onclick="document.getElementById('contactModal').style.display='block';">
                Contactar un agente
            </button>
        </div>

        {# Popup sin CSS  #}
        <div id="contactModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,.25); z-index:999;">
            <div style="background:#fff; max-width:350px; margin:120px auto; padding:1.5em 2em; border-radius:10px; box-shadow:0 4px 16px #0003;">
                <h3>Contactar un agente</h3>
                <p>
                    <strong>Email:</strong> manuelpborda@gmail.com<br>
                    <a href="mailto:manuelpborda@gmail.com?subject=Consulta sobre inmueble: {{ bien.typeDeBien }} en {{ bien.adresse }}">Enviar correo</a>
                </p>
                <p>
                    <strong>WhatsApp:</strong> +57 312 450 49 82<br>
                    <a href="https://wa.me/573215551234?text=Hola, quiero informaci√≥n sobre el inmueble '{{ bien.typeDeBien }}' en '{{ bien.adresse }}'" target="_blank">
                        Escribir por WhatsApp
                    </a>
                </p>
                <button onclick="document.getElementById('contactModal').style.display='none';">Cerrar</button>
            </div>
        </div>
    </main>
</div>
<script src="/js/favoris.js"></script>
{% endblock %}
